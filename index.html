<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#07090A">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>Tennis Scoreboard</title>
  
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    /* –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å–±—Ä–æ—Å–∞ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–∫—Ä–æ–ª–ª–∞ */
    body, html { 
      margin: 0; 
      padding: 0; 
      background-color: #07090A; 
      height: 100%; 
      overflow: hidden; 
      overscroll-behavior: none;
    }
  </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">
  // –ü–æ–ª—É—á–∞–µ–º —Ö—É–∫–∏ –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ React
  const { useState, useEffect, useCallback, useRef } = React;

  const PTS = ["0", "15", "30", "40"];

  /* ‚îÄ‚îÄ‚îÄ –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚îÄ‚îÄ‚îÄ */
  function speak(text) {
    if (!window.speechSynthesis) return;
    window.speechSynthesis.cancel();
    // –ü—ã—Ç–∞–µ–º—Å—è –≥–æ–≤–æ—Ä–∏—Ç—å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º, —Ç–∞–∫ –∫–∞–∫ —Ç–µ—Ä–º–∏–Ω—ã —Ç–µ–Ω–Ω–∏—Å–Ω—ã–µ (–º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –Ω–∞ ru-RU)
    const u = new SpeechSynthesisUtterance(text);
    u.lang = "en-US"; 
    u.rate = 0.9;
    u.volume = 1;
    window.speechSynthesis.speak(u);
  }

  function vibrate(pattern = 25) {
    try { if (navigator.vibrate) navigator.vibrate(pattern); } catch (e) {}
  }

  function fmtTime(ms) {
    const s = Math.floor(ms / 1000);
    return `${Math.floor(s / 60)}:${(s % 60).toString().padStart(2, "0")}`;
  }

  /* ‚îÄ‚îÄ‚îÄ –õ–æ–≥–∏–∫–∞ –¢–µ–Ω–Ω–∏—Å–∞ ‚îÄ‚îÄ‚îÄ */
  function freshMatch(server) {
    return {
      p1: 0, p2: 0,        // –û—á–∫–∏ –≤–Ω—É—Ç—Ä–∏ –≥–µ–π–º–∞ (0, 1, 2, 3...)
      g1: 0, g2: 0,        // –ì–µ–π–º—ã
      s1: 0, s2: 0,        // –°–µ—Ç—ã
      sets: [],            // –ò—Å—Ç–æ—Ä–∏—è —Å–µ—Ç–æ–≤
      tb: false, tb1: 0, tb2: 0, // –¢–∞–π–±—Ä–µ–π–∫
      deuce: false, adv: false, advP: null,
      over: false, winner: null,
      server,              // –ö—Ç–æ –ø–æ–¥–∞–µ—Ç (1 –∏–ª–∏ 2)
      pointNum: 0,         // –û–±—â–µ–µ –∫–æ–ª-–≤–æ —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π
    };
  }

  function clone(o) { return JSON.parse(JSON.stringify(o)); }

  function winGame(s, p) {
    if (p === 1) s.g1++; else s.g2++;
    s.p1 = 0; s.p2 = 0;
    s.deuce = false; s.adv = false; s.advP = null;
    s.tb1 = 0; s.tb2 = 0; s.tb = false;
    // –°–º–µ–Ω–∞ –ø–æ–¥–∞—á–∏ –ø–æ—Å–ª–µ –≥–µ–π–º–∞
    s.server = s.server === 1 ? 2 : 1;
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã –≤ —Å–µ—Ç–µ
    if (s.g1 >= 6 && s.g1 - s.g2 >= 2) return winSet(s, 1);
    if (s.g2 >= 6 && s.g2 - s.g1 >= 2) return winSet(s, 2);
    // –¢–∞–π–±—Ä–µ–π–∫ –ø—Ä–∏ 6-6
    if (s.g1 === 6 && s.g2 === 6) s.tb = true;
    return s;
  }

  function winSet(s, p) {
    s.sets.push({ a: s.g1, b: s.g2 });
    if (p === 1) s.s1++; else s.s2++;
    s.g1 = 0; s.g2 = 0;
    // –ü–æ–±–µ–¥–∞ –≤ –º–∞—Ç—á–µ (Best of 3)
    if (s.s1 >= 2) { s.over = true; s.winner = 1; }
    if (s.s2 >= 2) { s.over = true; s.winner = 2; }
    return s;
  }

  function point(prev, p) {
    const s = clone(prev);
    if (s.over) return s;
    s.pointNum++;

    // –õ–æ–≥–∏–∫–∞ –¢–∞–π–±—Ä–µ–π–∫–∞
    if (s.tb) {
      if (p === 1) s.tb1++; else s.tb2++;
      s.p1 = s.tb1; s.p2 = s.tb2;
      // –°–º–µ–Ω–∞ –ø–æ–¥–∞—á–∏ –∫–∞–∂–¥—ã–µ 2 –æ—á–∫–∞ (–ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ - —Å–º–µ–Ω–∞, –ø–æ—Ç–æ–º –∫–∞–∂–¥—ã–µ 2)
      if ((s.tb1 + s.tb2) % 2 === 1) s.server = s.server === 1 ? 2 : 1;
      
      if (s.tb1 >= 7 && s.tb1 - s.tb2 >= 2) return winGame(s, 1);
      if (s.tb2 >= 7 && s.tb2 - s.tb1 >= 2) return winGame(s, 2);
      return s;
    }

    // –õ–æ–≥–∏–∫–∞ Deuce / Advantage
    if (s.p1 >= 3 && s.p2 >= 3) {
      if (s.adv) {
        if (s.advP === p) return winGame(s, p); // –í—ã–∏–≥—Ä–∞–ª –≥–µ–π–º –∏–∑ AD
        s.adv = false; s.advP = null; s.deuce = true; // –í–µ—Ä–Ω—É–ª–∏—Å—å –≤ —Ä–æ–≤–Ω–æ
        return s;
      }
      if (s.deuce || (s.p1 === 3 && s.p2 === 3)) {
        s.deuce = false; s.adv = true; s.advP = p; // –ü–æ–ª—É—á–∏–ª AD
        return s;
      }
    }

    // –û–±—ã—á–Ω—ã–µ –æ—á–∫–∏
    if (p === 1) s.p1++; else s.p2++;
    if (s.p1 >= 4 && s.p1 - s.p2 >= 2) return winGame(s, 1); // 40 -> Game (–µ—Å–ª–∏ –Ω–µ—Ç —Ä–æ–≤–Ω–æ)
    if (s.p2 >= 4 && s.p2 - s.p1 >= 2) return winGame(s, 2);
    if (s.p1 >= 4) return winGame(s, 1); // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –≥–µ–π–º–æ–≤
    if (s.p2 >= 4) return winGame(s, 2);
    
    if (s.p1 === 3 && s.p2 === 3) s.deuce = true;
    return s;
  }

  function getPts(m, p) {
    if (m.tb) return p === 1 ? String(m.tb1) : String(m.tb2);
    if (m.deuce) return "40";
    if (m.adv) return m.advP === p ? "AD" : "40";
    const v = p === 1 ? m.p1 : m.p2;
    return PTS[v] || String(v);
  }

  function announce(m, n1, n2) {
    if (m.over) return `Game set and match, ${m.winner === 1 ? n1 : n2}`;
    if (m.tb) return `Tiebreak: ${m.tb1}, ${m.tb2}`;
    if (m.deuce) return "Deuce";
    if (m.adv) return `Advantage ${m.advP === 1 ? n1 : n2}`;
    const a = PTS[m.p1], b = PTS[m.p2];
    if (a === b && a !== "0") return `${a} all`;
    return `${a}, ${b}`;
  }

  /* ‚îÄ‚îÄ‚îÄ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã ‚îÄ‚îÄ‚îÄ */

  // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–¥–±—Ä–∞—Å—ã–≤–∞–Ω–∏—è –º–æ–Ω–µ—Ç–∫–∏
  function CoinToss({ p1, p2, onResult }) {
    const [phase, setPhase] = useState("idle");
    const [result, setResult] = useState(null);

    const toss = () => {
      vibrate(40);
      setPhase("spinning");
      const winner = Math.random() < 0.5 ? 1 : 2;
      setTimeout(() => {
        setResult(winner);
        setPhase("done");
        vibrate([20, 60, 20]);
      }, 1500);
    };

    const choose = (server) => {
      vibrate(30);
      speak(`${server === 1 ? p1 : p2} serves first`);
      onResult(server);
    };

    return (
      <div style={{
        display: "flex", flexDirection: "column", alignItems: "center",
        justifyContent: "center", gap: 24, animation: "fadeUp 0.4s ease",
        padding: "0 20px", width: "100%"
      }}>
        <p style={{ fontSize: 11, color: "#666", fontFamily: "var(--mono)", letterSpacing: 3, textTransform: "uppercase" }}>
          Who serves first?
        </p>

        <div style={{
          width: 120, height: 120, borderRadius: "50%",
          background: phase === "spinning"
            ? "conic-gradient(#C8FF00, #0a0f0a, #C8FF00, #0a0f0a, #C8FF00)"
            : result
            ? "linear-gradient(135deg, #C8FF00, #8BA600)"
            : "linear-gradient(135deg, #1a1f1a, #252a25)",
          border: `3px solid ${result ? "#C8FF00" : "#333"}`,
          display: "flex", alignItems: "center", justifyContent: "center",
          animation: phase === "spinning" ? `spin 0.3s linear infinite` : "none",
          boxShadow: result ? "0 0 40px rgba(200,255,0,0.3)" : "0 4px 20px rgba(0,0,0,0.5)",
          cursor: phase === "idle" ? "pointer" : "default",
        }}
        onClick={phase === "idle" ? toss : undefined}
        >
          {phase === "idle" && <span style={{ fontSize: 36 }}>üéæ</span>}
          {phase === "spinning" && <span style={{ fontSize: 28, filter: "blur(2px)" }}>üéæ</span>}
          {phase === "done" && (
            <div style={{ textAlign: "center" }}>
              <div style={{ fontSize: 11, fontWeight: 800, color: "#0a0f0a", fontFamily: "var(--mono)" }}>WON</div>
              <div style={{ fontSize: 16, fontWeight: 900, color: "#0a0f0a" }}>{result === 1 ? p1 : p2}</div>
            </div>
          )}
        </div>

        {(phase === "idle" || phase === "done") && (
          <div style={{ display: "flex", gap: 10, width: "100%", maxWidth: 300 }}>
            <button onClick={() => choose(1)} style={{
              flex: 1, padding: "14px 0",
              background: phase === "done" && result === 1 ? "rgba(200,255,0,0.12)" : "rgba(255,255,255,0.04)",
              border: `1px solid ${phase === "done" && result === 1 ? "rgba(200,255,0,0.3)" : "rgba(255,255,255,0.08)"}`,
              borderRadius: 12, color: "#ccc", fontSize: 13, fontWeight: 700, fontFamily: "var(--font)",
            }}>üéæ {p1}</button>
            <button onClick={() => choose(2)} style={{
              flex: 1, padding: "14px 0",
              background: phase === "done" && result === 2 ? "rgba(200,255,0,0.12)" : "rgba(255,255,255,0.04)",
              border: `1px solid ${phase === "done" && result === 2 ? "rgba(200,255,0,0.3)" : "rgba(255,255,255,0.08)"}`,
              borderRadius: 12, color: "#ccc", fontSize: 13, fontWeight: 700, fontFamily: "var(--font)",
            }}>üéæ {p2}</button>
          </div>
        )}
      </div>
    );
  }

  // –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
  function TennisScoreboard() {
    const [screen, setScreen] = useState("setup");
    const [p1, setP1] = useState("Player 1");
    const [p2, setP2] = useState("Player 2");
    const [match, setMatch] = useState(null);
    const [hist, setHist] = useState([]);
    const [elapsed, setElapsed] = useState(0);
    const [flash, setFlash] = useState(null);
    const [lastMsg, setLastMsg] = useState(null);
    const timerRef = useRef(null);
    const startRef = useRef(null);
    const wakeLockRef = useRef(null);

    // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É–≥–∞—Å–∞–Ω–∏—è —ç–∫—Ä–∞–Ω–∞
    const lockScreen = async () => {
      try { if ("wakeLock" in navigator) wakeLockRef.current = await navigator.wakeLock.request("screen"); } catch(e) { console.log("WakeLock error", e); }
    };
    const unlockScreen = () => {
      if (wakeLockRef.current) {
        wakeLockRef.current.release().catch(() => {});
        wakeLockRef.current = null;
      }
    };

    const startTimer = () => {
      startRef.current = Date.now();
      timerRef.current = setInterval(() => setElapsed(Date.now() - startRef.current), 1000);
    };
    const stopTimer = () => clearInterval(timerRef.current);

    const goToToss = () => {
      if (!p1.trim()) setP1("Player 1");
      if (!p2.trim()) setP2("Player 2");
      setScreen("toss");
    };

    const startMatch = (server) => {
      setMatch(freshMatch(server));
      setHist([]);
      setElapsed(0);
      setScreen("match");
      startTimer();
      lockScreen();
    };

    const doScore = useCallback((p) => {
      if (!match || match.over) return;
      vibrate(30);
      setHist(h => [...h, clone(match)]);
      const next = point(match, p);
      setMatch(next);
      
      const msg = announce(next, p1, p2);
      speak(msg);
      setLastMsg(msg);
      setFlash(p);
      setTimeout(() => { setFlash(null); setLastMsg(null); }, 1800);

      if (next.over) {
        setTimeout(() => { stopTimer(); setScreen("final"); }, 2500);
      }
    }, [match, p1, p2]);

    const doUndo = useCallback(() => {
      if (hist.length === 0) return;
      vibrate(20);
      setMatch(hist[hist.length - 1]);
      setHist(h => h.slice(0, -1));
      speak("Undo");
      setLastMsg("‚Ü© Undo");
      setTimeout(() => setLastMsg(null), 1200);
    }, [hist]);

    const reset = () => { stopTimer(); unlockScreen(); setScreen("setup"); };

    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–¥–ª—è —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –ü–ö)
    useEffect(() => {
      if (screen !== "match") return;
      const h = (e) => {
        if (e.key === "ArrowLeft" || e.key === "1") doScore(1);
        else if (e.key === "ArrowRight" || e.key === "2") doScore(2);
        else if (e.key === "z" || e.key === "Z") doUndo();
      };
      window.addEventListener("keydown", h);
      return () => window.removeEventListener("keydown", h);
    }, [screen, doScore, doUndo]);

    useEffect(() => () => { stopTimer(); unlockScreen(); }, []);

    const lime = "#C8FF00";
    const bg = "#07090A";

    return (
      <div style={{
        "--font": "'Outfit', sans-serif",
        "--mono": "'DM Mono', monospace",
        height: "100vh", height: "100dvh",
        background: bg,
        fontFamily: "var(--font)",
        display: "flex", flexDirection: "column",
        overflow: "hidden",
        userSelect: "none",
        WebkitUserSelect: "none",
      }}>
        <style>{`
          @import url('https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=Outfit:wght@400;600;700;800;900&display=swap');
          @keyframes fadeUp { from { opacity: 0; transform: translateY(14px); } to { opacity: 1; transform: translateY(0); } }
          @keyframes pulseGlow { 0%,100% { box-shadow: 0 0 20px rgba(200,255,0,0.15); } 50% { box-shadow: 0 0 50px rgba(200,255,0,0.35); } }
          @keyframes spin { to { transform: rotate(360deg); } }
          @keyframes flashL { 0% { background: linear-gradient(90deg, rgba(200,255,0,0.12) 0%, transparent 50%); } 100% { background: transparent; } }
          @keyframes flashR { 0% { background: linear-gradient(270deg, rgba(200,255,0,0.12) 0%, transparent 50%); } 100% { background: transparent; } }
          @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
          @keyframes bounce { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }
          * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
          button { font-family: var(--font); cursor: pointer; border: none; }
          button:active { transform: scale(0.96); }
          input:focus { outline: none; }
        `}</style>

        {/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê –≠–ö–†–ê–ù 1: –ù–ê–°–¢–†–û–ô–ö–ê ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */}
        {screen === "setup" && (
          <div style={{ flex: 1, display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", padding: 24, animation: "fadeUp 0.5s ease" }}>
            <div style={{ width: 64, height: 64, borderRadius: 18, background: `linear-gradient(135deg, ${lime}, #7CB800)`, display: "flex", alignItems: "center", justifyContent: "center", fontSize: 32, marginBottom: 16 }}>üéæ</div>
            <h1 style={{ fontSize: 28, fontWeight: 900, color: "#fff", letterSpacing: -0.5, marginBottom: 2 }}>Tennis Score</h1>
            <p style={{ fontSize: 11, color: "#555", fontFamily: "var(--mono)", letterSpacing: 3, marginBottom: 36 }}>SMART SCOREBOARD</p>

            <div style={{ width: "100%", maxWidth: 340 }}>
              {[{ l: "PLAYER 1", v: p1, s: setP1 }, { l: "PLAYER 2", v: p2, s: setP2 }].map((f, i) => (
                <div key={i} style={{ marginBottom: 14 }}>
                  <label style={{ fontSize: 10, color: "#555", fontFamily: "var(--mono)", letterSpacing: 2, marginBottom: 5, display: "block" }}>{f.l}</label>
                  <input value={f.v} onChange={e => f.s(e.target.value)}
                    onFocus={e => e.target.style.borderColor = lime}
                    onBlur={e => e.target.style.borderColor = "rgba(255,255,255,0.08)"}
                    style={{ width: "100%", padding: "13px 14px", background: "rgba(255,255,255,0.04)", border: "1px solid rgba(255,255,255,0.08)", borderRadius: 10, color: "#fff", fontSize: 16, fontWeight: 600, fontFamily: "var(--font)" }}
                  />
                </div>
              ))}

              <button onClick={goToToss} style={{ width: "100%", marginTop: 10, padding: "16px 0", background: `linear-gradient(135deg, ${lime}, #9BCC00)`, borderRadius: 14, color: bg, fontSize: 16, fontWeight: 800, letterSpacing: 0.5, animation: "pulseGlow 2.5s infinite" }}>
                Start Game ‚Üí
              </button>
            </div>
          </div>
        )}

        {/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê –≠–ö–†–ê–ù 2: –ñ–†–ï–ë–ò–ô ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */}
        {screen === "toss" && (
          <div style={{ flex: 1, display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center" }}>
            <CoinToss p1={p1} p2={p2} onResult={startMatch} />
          </div>
        )}

        {/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê –≠–ö–†–ê–ù 3: –ú–ê–¢–ß ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */}
        {screen === "match" && match && (
          <div style={{
            flex: 1, display: "flex", flexDirection: "column",
            animation: flash === 1 ? "flashL 0.6s ease" : flash === 2 ? "flashR 0.6s ease" : "none",
          }}>
            {/* –í–µ—Ä—Ö–Ω–∏–π –±–∞—Ä */}
            <div style={{ padding: "10px 16px", display: "flex", justifyContent: "space-between", alignItems: "center" }}>
              <span style={{ fontSize: 12, color: "#555", fontFamily: "var(--mono)" }}>{fmtTime(elapsed)}</span>
              <span style={{ fontSize: 10, color: "#444", fontFamily: "var(--mono)", letterSpacing: 2 }}>
                {match.tb ? "TIEBREAK" : match.deuce ? "DEUCE" : match.adv ? "ADV" : `SET ${match.sets.length + 1}`}
              </span>
              <span style={{ fontSize: 12, color: "#555", fontFamily: "var(--mono)" }}>PT {match.pointNum}</span>
            </div>

            {/* –°—á–µ—Ç –ø–æ —Å–µ—Ç–∞–º (–∏—Å—Ç–æ—Ä–∏—è) */}
            {match.sets.length > 0 && (
              <div style={{ display: "flex", justifyContent: "center", gap: 12, padding: "0 16px 8px" }}>
                {match.sets.map((s, i) => (
                  <div key={i} style={{ display: "flex", gap: 4, alignItems: "center" }}>
                    <span style={{ fontSize: 12, color: s.a > s.b ? lime : "#555", fontWeight: 700, fontFamily: "var(--mono)" }}>{s.a}</span>
                    <span style={{ fontSize: 10, color: "#333" }}>‚Äì</span>
                    <span style={{ fontSize: 12, color: s.b > s.a ? lime : "#555", fontWeight: 700, fontFamily: "var(--mono)" }}>{s.b}</span>
                  </div>
                ))}
              </div>
            )}

            {/* –û—Å–Ω–æ–≤–Ω–æ–µ –¢–∞–±–ª–æ */}
            <div style={{ flex: 1, display: "flex", flexDirection: "column", justifyContent: "center", padding: "0 16px" }}>
              <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 12, marginBottom: 16 }}>
                {[1, 2].map(pl => {
                  const name = pl === 1 ? p1 : p2;
                  const sets = pl === 1 ? match.s1 : match.s2;
                  const games = pl === 1 ? match.g1 : match.g2;
                  const pts = getPts(match, pl);
                  const isServing = match.server === pl;
                  const isAdv = match.adv && match.advP === pl;

                  return (
                    <div key={pl} style={{
                      background: "rgba(255,255,255,0.03)",
                      border: `1px solid ${isAdv ? "rgba(200,255,0,0.2)" : "rgba(255,255,255,0.05)"}`,
                      borderRadius: 20, padding: "20px 16px 18px",
                      textAlign: "center", position: "relative",
                      transition: "border-color 0.3s",
                    }}>
                      {/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–¥–∞—á–∏ */}
                      {isServing && (
                        <div style={{
                          position: "absolute", top: 12, right: 14,
                          width: 8, height: 8, borderRadius: "50%",
                          background: lime, boxShadow: `0 0 8px ${lime}`,
                        }} />
                      )}

                      <div style={{ fontSize: 14, fontWeight: 700, color: "#bbb", marginBottom: 10, whiteSpace: "nowrap", overflow: "hidden", textOverflow: "ellipsis" }}>{name}</div>

                      {/* –ì–µ–π–º—ã –∏ —Å–µ—Ç—ã */}
                      <div style={{ display: "flex", justifyContent: "center", gap: 16, marginBottom: 12 }}>
                        <div>
                          <div style={{ fontSize: 9, color: "#444", fontFamily: "var(--mono)", letterSpacing: 2, marginBottom: 2 }}>SETS</div>
                          <div style={{ fontSize: 22, fontWeight: 800, color: "#fff" }}>{sets}</div>
                        </div>
                        <div style={{ width: 1, background: "rgba(255,255,255,0.06)" }} />
                        <div>
                          <div style={{ fontSize: 9, color: "#444", fontFamily: "var(--mono)", letterSpacing: 2, marginBottom: 2 }}>GAMES</div>
                          <div style={{ fontSize: 22, fontWeight: 800, color: "#fff" }}>{games}</div>
                        </div>
                      </div>

                      {/* –û—á–∫–∏ (–ë–æ–ª—å—à–∏–µ —Ü–∏—Ñ—Ä—ã) */}
                      <div style={{
                        fontSize: 72, fontWeight: 900, lineHeight: 1,
                        color: pts === "AD" ? lime : "#fff",
                        transition: "color 0.3s",
                      }}>{pts}</div>
                    </div>
                  );
                })}
              </div>

              {/* –°–æ–æ–±—â–µ–Ω–∏—è (–∞–Ω–æ–Ω—Å) */}
              <div style={{ minHeight: 28, textAlign: "center", marginBottom: 8 }}>
                {lastMsg && (
                  <div style={{
                    display: "inline-block", background: "rgba(200,255,0,0.08)",
                    border: "1px solid rgba(200,255,0,0.15)", borderRadius: 8,
                    padding: "5px 16px", fontSize: 14, fontWeight: 700, color: lime,
                    animation: "popIn 0.25s ease",
                  }}>üîä {lastMsg}</div>
                )}
              </div>
            </div>

            {/* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */}
            <div style={{ padding: "0 16px 20px", flexShrink: 0 }}>
              <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 10, marginBottom: 10 }}>
                {[1, 2].map(pl => (
                  <button key={pl} onClick={() => doScore(pl)} style={{
                    padding: "20px 0",
                    background: `linear-gradient(135deg, ${lime}, #9BCC00)`,
                    borderRadius: 14, color: bg,
                    fontSize: 15, fontWeight: 800,
                  }}>
                    {pl === 1 ? "‚óÄ " : ""}{pl === 1 ? p1 : p2}{pl === 2 ? " ‚ñ∂" : ""}
                  </button>
                ))}
              </div>

              <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 10 }}>
                <button onClick={doUndo} disabled={hist.length === 0} style={{
                  padding: "13px 0", background: "transparent",
                  border: `1px solid ${hist.length > 0 ? "rgba(255,255,255,0.1)" : "rgba(255,255,255,0.03)"}`,
                  borderRadius: 12, color: hist.length > 0 ? "#777" : "#2a2a2a",
                  fontSize: 13, fontWeight: 600,
                }}>‚Ü© Undo</button>
                <button onClick={() => { stopTimer(); unlockScreen(); setScreen("final"); }} style={{
                  padding: "13px 0", background: "transparent",
                  border: "1px solid rgba(255,255,255,0.06)",
                  borderRadius: 12, color: "#444", fontSize: 13, fontWeight: 600,
                }}>‚úï End Match</button>
              </div>
            </div>
          </div>
        )}

        {/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê –≠–ö–†–ê–ù 4: –§–ò–ù–ê–õ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */}
        {screen === "final" && match && (
          <div style={{ flex: 1, display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", padding: 24, animation: "fadeUp 0.5s ease" }}>
            <div style={{ fontSize: 52, marginBottom: 12, animation: "bounce 1s ease 0.3s" }}>üèÜ</div>
            {match.winner ? (
              <h2 style={{ fontSize: 24, fontWeight: 900, color: lime, marginBottom: 4 }}>{match.winner === 1 ? p1 : p2} Wins!</h2>
            ) : (
              <h2 style={{ fontSize: 24, fontWeight: 900, color: "#888", marginBottom: 4 }}>Match Ended</h2>
            )}
            <p style={{ fontSize: 14, color: "#888", marginBottom: 6 }}>{p1} vs {p2}</p>

            <div style={{
              background: "rgba(255,255,255,0.03)", borderRadius: 14, padding: 18,
              marginBottom: 8, minWidth: 200,
            }}>
              <div style={{ display: "grid", gridTemplateColumns: `auto ${match.sets.map(() => "40px").join(" ")} 40px`, gap: 4, alignItems: "center", fontSize: 13, fontFamily: "var(--mono)" }}>
                <span style={{ color: "#888", fontWeight: 700 }}>{p1}</span>
                {match.sets.map((s, i) => <span key={i} style={{ textAlign: "center", color: s.a > s.b ? lime : "#555", fontWeight: 700 }}>{s.a}</span>)}
                {!match.over && <span style={{ textAlign: "center", color: "#555" }}>{match.g1}</span>}
                
                <span style={{ color: "#888", fontWeight: 700 }}>{p2}</span>
                {match.sets.map((s, i) => <span key={i} style={{ textAlign: "center", color: s.b > s.a ? lime : "#555", fontWeight: 700 }}>{s.b}</span>)}
                {!match.over && <span style={{ textAlign: "center", color: "#555" }}>{match.g2}</span>}
              </div>
            </div>

            <p style={{ fontSize: 12, color: "#444", fontFamily: "var(--mono)", marginBottom: 28 }}>
              {fmtTime(elapsed)} ¬∑ {match.pointNum} points
            </p>

            <button onClick={reset} style={{
              padding: "14px 40px", background: `linear-gradient(135deg, ${lime}, #9BCC00)`,
              borderRadius: 14, color: bg, fontSize: 15, fontWeight: 800,
            }}>New Match</button>
          </div>
        )}
      </div>
    );
  }

  // –†–µ–Ω–¥–µ—Ä–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ div#root
  const root = ReactDOM.createRoot(document.getElementById("root"));
  root.render(<TennisScoreboard />);
</script>

</body>
</html>
